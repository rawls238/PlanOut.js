!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.planout=e():t.planout=e()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e["default"]=t,e}function i(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=r(1),u=i(o),a=r(13),s=i(a),f=r(3),l=i(f),c=r(15),h=i(c),p=r(16),g=n(p),y=r(2),v=i(y),m=r(17),d=i(m);e["default"]={Namespace:g,Assignment:v["default"],Interpreter:s["default"],Experiment:u["default"],ExperimentSetup:d["default"],Ops:{Random:l["default"],Core:h["default"]}},t.exports=e["default"]},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=r(2),a=n(u),s=r(5),f=function(){function t(e){i(this,t),this.inputs=e,this._exposureLogged=!1,this._salt=null,this._inExperiment=!0,this.name=this.getDefaultExperimentName(),this._autoExposureLog=!0,this.setup(),this._assignment=new a["default"](this.getSalt()),this._assigned=!1}return o(t,[{key:"getDefaultExperimentName",value:function(){if((0,s.isObject)(this)&&this.constructor&&this!==this.window){var t=this.constructor.toString().match(/function\s*(\w+)/);if(t&&2===t.length)return t[1]}return"GenericExperiment"}},{key:"getDefaultParamNames",value:function(){var t=this.assign.toString(),e=t.split(".set(");return e.splice(0,1),(0,s.map)(e,function(t){var e=(0,s.trimTrailingWhitespace)(t.split(",")[0]);return e.substr(1,e.length-2)})}},{key:"requireAssignment",value:function(){this._assigned||this._assign()}},{key:"requireExposureLogging",value:function(t){this.shouldLogExposure(t)&&this.logExposure()}},{key:"_assign",value:function(){this.configureLogger();var t=this.assign(this._assignment,this.inputs);t||void 0===t?this._inExperiment=!0:this._inExperiment=!1,this._assigned=!0}},{key:"setup",value:function(){}},{key:"inExperiment",value:function(){return this._inExperiment}},{key:"addOverride",value:function(t,e){this._assignment.addOverride(t,e)}},{key:"setOverrides",value:function(t){this._assignment.setOverrides(t);var e=this._assignment.getOverrides(),r=this;(0,s.forEach)(Object.keys(e),function(t){void 0!==r.inputs[t]&&(r.inputs[t]=e[t])})}},{key:"getSalt",value:function(){return this._salt?this._salt:this.name}},{key:"setSalt",value:function(t){this._salt=t,this._assignment&&(this._assignment.experimentSalt=t)}},{key:"getName",value:function(){return this.name}},{key:"assign",value:function(t,e){throw"IMPLEMENT assign"}},{key:"getParamNames",value:function(){throw"IMPLEMENT getParamNames"}},{key:"shouldFetchExperimentParameter",value:function(t){var e=this.getParamNames();return e.indexOf(t)>=0}},{key:"setName",value:function(t){var e=/\s+/g;this.name=t.replace(e,"-"),this._assignment&&(this._assignment.experimentSalt=this.getSalt())}},{key:"__asBlob",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e={name:this.getName(),time:(new Date).getTime()/1e3,salt:this.getSalt(),inputs:this.inputs,params:this._assignment.getParams()};return(0,s.extend)(e,t),e}},{key:"setAutoExposureLogging",value:function(t){this._autoExposureLog=t}},{key:"getParams",value:function(){return this.requireAssignment(),this.requireExposureLogging(),this._assignment.getParams()}},{key:"get",value:function(t,e){return this.requireAssignment(),this.requireExposureLogging(t),this._assignment.get(t,e)}},{key:"toString",value:function(){return this.requireAssignment(),this.requireExposureLogging(),JSON.stringify(this.__asBlob())}},{key:"logExposure",value:function(t){this.inExperiment()&&(this._exposureLogged=!0,this.logEvent("exposure",t))}},{key:"shouldLogExposure",value:function(t){return!(void 0!==t&&!this.shouldFetchExperimentParameter(t))&&(this._autoExposureLog&&!this.previouslyLogged())}},{key:"logEvent",value:function(t,e){if(this.inExperiment()){var r;r=e?{event:t,extra_data:(0,s.shallowCopy)(e)}:{event:t},this.log(this.__asBlob(r))}}},{key:"configureLogger",value:function(){throw"IMPLEMENT configureLogger"}},{key:"log",value:function(t){throw"IMPLEMENT log"}},{key:"previouslyLogged",value:function(){throw"IMPLEMENT previouslyLogged"}}]),t}();e["default"]=f,t.exports=e["default"]},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=r(3),u=r(5),a=function(){function t(e,r){n(this,t),r||(r={}),this.experimentSalt=e,this._overrides=(0,u.shallowCopy)(r),this._data=(0,u.shallowCopy)(r),this.saltSeparator="."}return i(t,[{key:"evaluate",value:function(t){return t}},{key:"getOverrides",value:function(){return this._overrides}},{key:"addOverride",value:function(t,e){this._overrides[t]=e,this._data[t]=e}},{key:"setOverrides",value:function(t){this._overrides=(0,u.shallowCopy)(t);var e=this;(0,u.forEach)(Object.keys(this._overrides),function(t){e._data[t]=e._overrides[t]})}},{key:"set",value:function(t,e){return"_data"===t?void(this._data=e):"_overrides"===t?void(this._overrides=e):"experimentSalt"===t?void(this.experimentSalt=e):"saltSeparator"===t?void(this.saltSeparator=e):void((0,u.hasKey)(this._overrides,t)||(e instanceof o.PlanOutOpRandom?(e.args.salt||(e.args.salt=t),this._data[t]=e.execute(this)):this._data[t]=e))}},{key:"get",value:function(t){return"_data"===t?this._data:"_overrides"===t?this._overrides:"experimentSalt"===t?this.experimentSalt:"saltSeparator"===t?this.saltSeparator:this._data[t]}},{key:"getParams",value:function(){return this._data}},{key:"del",value:function(t){delete this._data[t]}},{key:"toString",value:function(){return String(this._data)}},{key:"length",value:function(){return Object.keys(this._data).length}}]),t}();e["default"]=a,t.exports=e["default"]},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=r(4),f=r(6),l=n(f),c=r(5),h=function(t){function e(t){i(this,e);var r=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.LONG_SCALE=0xfffffffffffff,r}return u(e,t),a(e,[{key:"compatHashCalculation",value:function(t){return parseInt(t.substr(0,13),16)}},{key:"compatZeroToOneCalculation",value:function(t){return this.getHash(t)/this.LONG_SCALE}},{key:"getUnit",value:function(t){var e=this.getArgMixed("unit");return(0,c.isArray)(e)||(e=[e]),t&&e.push(t),e}},{key:"getUniform",value:function(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],e=arguments.length<=1||void 0===arguments[1]?1:arguments[1],r=arguments[2],n=this.compatZeroToOneCalculation(r);return n*(e-t)+t}},{key:"getHash",value:function(t){var e;if(this.args.full_salt)e=this.getArgString("full_salt")+".";else{var r=this.getArgString("salt");e=this.mapper.get("experimentSalt")+"."+r+this.mapper.get("saltSeparator")}var n=this.getUnit(t).map(function(t){return String(t)}).join("."),i=e+n,o=(0,l["default"])(i);return this.compatHashCalculation(o)}}]),e}(s.PlanOutOpSimple),p=function(t){return function(t){function e(){return i(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return u(e,t),a(e,[{key:"simpleExecute",value:function(){var t=this.getArgNumber("min"),e=this.getArgNumber("max");return this.getUniform(t,e)}}]),e}(t)},g=function(t){return function(t){function e(){return i(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return u(e,t),a(e,[{key:"compatRandomIntegerCalculation",value:function(t,e){return(this.getHash()+t)%(e-t+1)}},{key:"simpleExecute",value:function(){var t=this.getArgNumber("min"),e=this.getArgNumber("max");return this.compatRandomIntegerCalculation(t,e)}}]),e}(t)},y=function(t){return function(t){function e(){return i(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return u(e,t),a(e,[{key:"simpleExecute",value:function(){var t=this.getArgNumber("p");if(t<0||t>1)throw"Invalid probability";return this.getUniform(0,1)<=t?1:0}}]),e}(t)},v=function(t){return function(t){function e(){return i(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return u(e,t),a(e,[{key:"simpleExecute",value:function(){var t=this.getArgNumber("p"),e=this.getArgList("choices");if(t<0||t>1)throw"Invalid probability";if(0==e.length)return[];for(var r=[],n=0;n<e.length;n++){var i=e[n];this.getUniform(0,1,i)<=t&&r.push(i)}return r}}]),e}(t)},m=function(t){return function(t){function e(){return i(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return u(e,t),a(e,[{key:"compatRandomIndexCalculation",value:function(t){return this.getHash()%t.length}},{key:"simpleExecute",value:function(){var t=this.getArgList("choices");if(0===t.length)return[];var e=this.compatRandomIndexCalculation(t);return t[e]}}]),e}(t)},d=function(t){return function(t){function e(){return i(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return u(e,t),a(e,[{key:"simpleExecute",value:function(){var t=this.getArgList("choices"),e=this.getArgList("weights");if(0===t.length)return[];var r=0,n=e.map(function(t){return r+=t}),i=this.getUniform(0,r);return(0,c.reduce)(n,function(e,r,n){return e?e:i<=r?t[n]:e},null)}}]),e}(t)},_=function(t){return function(t){function e(){return i(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return u(e,t),a(e,[{key:"compatSampleIndexCalculation",value:function(t){return this.getHash(t)%(t+1)}},{key:"compatAllowSampleStoppingPoint",value:function(){return!0}},{key:"sample",value:function(t,e){for(var r=t.length,n=r-e,i=this.compatAllowSampleStoppingPoint(),o=r-1;o>0;o--){var u=this.compatSampleIndexCalculation(o),a=t[o];if(t[o]=t[u],t[u]=a,i&&n===o)return t.slice(o,r)}return t.slice(0,e)}},{key:"simpleExecute",value:function(){var t=(0,c.shallowCopy)(this.getArgList("choices")),e=0;return e=void 0!==this.args.draws?this.getArgNumber("draws"):t.length,this.sample(t,e)}}]),e}(t)};e["default"]={PlanOutOpRandom:h,SampleBuilder:_,Sample:_(h),WeightedChoiceBuilder:d,WeightedChoice:d(h),UniformChoiceBuilder:m,UniformChoice:m(h),BernoulliFilterBuilder:v,BernoulliFilter:v(h),BernoulliTrialBuilder:y,BernoulliTrial:y(h),RandomIntegerBuilder:g,RandomInteger:g(h),RandomFloatBuilder:p,RandomFloat:p(h)},t.exports=e["default"]},function(t,e,r){"use strict";function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.PlanOutOpUnary=e.PlanOutOpBinary=e.PlanOutOpCommutative=e.PlanOutOpSimple=e.PlanOutOp=void 0;var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=r(5),s=function(){function t(e){o(this,t),this.args=e}return u(t,[{key:"execute",value:function(t){throw"Implement the execute function"}},{key:"dumpArgs",value:function(){console.log(this.args)}},{key:"getArgMixed",value:function(t){if(void 0===this.args[t])throw"Missing argument "+t;return this.args[t]}},{key:"getArgNumber",value:function(t){var e=this.getArgMixed(t);if("number"!=typeof e)throw t+" is not a number.";return e}},{key:"getArgString",value:function(t){var e=this.getArgMixed(t);if("string"!=typeof e)throw t+" is not a string.";return e}},{key:"getArgList",value:function(t){var e=this.getArgMixed(t);if("[object Array]"!==Object.prototype.toString.call(e))throw t+" is not a list";return e}},{key:"getArgObject",value:function(t){var e=this.getArgMixed(t);if("[object Object]"!==Object.prototype.toString.call(e))throw t+" is not an object.";return e}},{key:"getArgIndexish",value:function(t){var e=this.getArgMixed(t),r=Object.prototype.toString.call(e);if("[object Object]"!==r&&"[object Array]"!==r)throw t+" is not an list or object.";return e}}]),t}(),f=function(t){function e(){return o(this,e),n(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),u(e,[{key:"execute",value:function(t){this.mapper=t;var e=this;return(0,a.forEach)(Object.keys(this.args),function(r){e.args[r]=t.evaluate(e.args[r])}),this.simpleExecute()}}]),e}(s),l=function(t){function e(){return o(this,e),n(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),u(e,[{key:"simpleExecute",value:function(){return this.unaryExecute(this.getArgMixed("value"))}},{key:"getUnaryString",value:function(){return this.args.op}},{key:"unaryExecute",value:function(t){throw"implement unaryExecute"}}]),e}(f),c=function(t){function e(){return o(this,e),n(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),u(e,[{key:"simpleExecute",value:function(){var t=this.getArgMixed("left"),e=this.getArgMixed("right");return this.binaryExecute(t,e)}},{key:"getInfixString",value:function(){return this.args.op}},{key:"binaryExecute",value:function(t,e){throw"implement binaryExecute"}}]),e}(f),h=function(t){function e(){return o(this,e),n(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),u(e,[{key:"simpleExecute",value:function(){return this.commutativeExecute(this.getArgList("values"))}},{key:"getCommutativeString",value:function(){return this.args.op}},{key:"commutativeExecute",value:function(t){throw"implement commutativeExecute"}}]),e}(f);e.PlanOutOp=s,e.PlanOutOpSimple=f,e.PlanOutOpCommutative=h,e.PlanOutOpBinary=c,e.PlanOutOpUnary=l},function(t,e){"use strict";function r(t,e){var r=T.length,n=t.constructor,i=f(n)&&n.prototype||Object.Prototype,o="constructor";for(S(t,o)&&!R(e,o)&&e.push(o);r--;)o=T[r],o in t&&t[o]!==i[o]&&!R(e,o)&&e.push(o)}Object.defineProperty(e,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},i=function(t){return t.replace(/^\s+|\s+$/g,"")},o=function(t){var e,r="undefined"!=typeof location,n="undefined"!=typeof window;if(r){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+t+"=([^&#]*)"),o=i.exec(location.search);e=null===o?"":decodeURIComponent(o[1].replace(/\+/g," "))}else e="";return null!==e&&void 0!==e&&0!==e.length||!n||void 0===window.localStorage||null===window.localStorage?e:window.localStorage.getItem(t)},u=function C(t){var e=t;if(t&&"object"===("undefined"==typeof t?"undefined":n(t))){e="[object Array]"===Object.prototype.toString.call(t)?[]:{};for(var r in t)e[r]=C(t[r])}return e},a=function(t){var e="undefined"==typeof t?"undefined":n(t);return"function"===e||"object"===e&&!!t},s=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)},f=function(t){return"function"==typeof t||!1},l=function I(t){if(!a(t))return[];if(Object.keys)return Object.keys(t);var I=[];for(var e in t)S(t,e)&&I.push(e);return j&&r(t,I),I},c=function(t){if(!a(t))return[];var e=[];for(var n in t)e.push(n);return j&&r(t,e),e},h=function(t,e){return function(r){var n=arguments.length;if(n<2||null==r)return r;for(var i=1;i<n;i++)for(var o=arguments[i],u=t(o),a=u.length,s=0;s<a;s++){var f=u[s];e&&void 0!==r[f]||(r[f]=o[f])}return r}},p=h(c),g=h(l),y=function(t){return t},v=function(t,e){var r=r(e),n=r.length;if(null==t)return!n;for(var i=Object(t),o=0;o<n;o++){var u=r[o];if(e[u]!==i[u]||!(u in i))return!1}return!0},m=function(t){return t=g({},t),function(e){return v(e,t)}},d=function(t,e,r){return null==t?y:f(t)?_(t,e,r):a(t)?m(t):w(t)},_=function(t,e,r){if(void 0===e)return t;switch(null==r?3:r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)};case 4:return function(r,n,i,o){return t.call(e,r,n,i,o)}}return function(){return t.apply(e,arguments)}},O=function(t,e,r){e=_(e,r);var n,i;if(k(t))for(n=0,i=t.length;n<i;n++)e(t[n],n,t);else{var o=l(t);for(n=0,i=o.length;n<i;n++)e(t[o[n]],o[n],t)}return t},b=function(t,e,r){e=d(e,r);for(var n=!k(t)&&l(t),i=(n||t).length,o=Array(i),u=0;u<i;u++){var a=n?n[u]:u;o[u]=e(t[a],a,t)}return o},E=function(t,e,r,n){e=_(e,n,4);var i=!k(t)&&l(t),o=(i||t).length,u=0;for(arguments.length<3&&(r=t[i?i[u]:u],u+=1);u>=0&&u<o;u++){var a=i?i[u]:u;r=e(r,t[a],a,t)}return r},x=function(t){return a(t)?s(t)?t.slice():p({},t):t},w=function(t){return function(e){return null==e?void 0:e[t]}},P=Math.pow(2,53)-1,A=w("length"),k=function(t){var e=A(t);return"number"==typeof e&&e>=0&&e<=P},S=function(t,e){return null!=t&&Object.prototype.hasOwnProperty.call(t,e)},j=!{toString:null}.propertyIsEnumerable("toString"),T=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],R=function(t,e,r,n){return k(t)||(t=M(t)),("number"!=typeof r||n)&&(r=0),t.indexOf(e)>=0},M=function(t){for(var e=l(t),r=e.length,n=Array(r),i=0;i<r;i++)n[i]=t[e[i]];return n},B=function(t){for(var e=[],r=0;r<t;r++)e.push(r);return e},L=function(t,e){return"undefined"!=typeof t[e]};e["default"]={deepCopy:u,map:b,reduce:E,getParameterByName:o,forEach:O,isFunction:f,trimTrailingWhitespace:i,hasKey:L,shallowCopy:x,extend:p,isObject:a,isArray:s,range:B},t.exports=e["default"]},function(t,e,r){(function(e){!function(){var n=r(11),i=r(12).utf8,o=r(12).bin,u=function(t){t.constructor==String?t=i.stringToBytes(t):"undefined"!=typeof e&&"function"==typeof e.isBuffer&&e.isBuffer(t)?t=Array.prototype.slice.call(t,0):Array.isArray(t)||(t=t.toString());var r=n.bytesToWords(t),o=8*t.length,u=[],a=1732584193,s=-271733879,f=-1732584194,l=271733878,c=-1009589776;r[o>>5]|=128<<24-o%32,r[(o+64>>>9<<4)+15]=o;for(var h=0;h<r.length;h+=16){for(var p=a,g=s,y=f,v=l,m=c,d=0;d<80;d++){if(d<16)u[d]=r[h+d];else{var _=u[d-3]^u[d-8]^u[d-14]^u[d-16];u[d]=_<<1|_>>>31}var O=(a<<5|a>>>27)+c+(u[d]>>>0)+(d<20?(s&f|~s&l)+1518500249:d<40?(s^f^l)+1859775393:d<60?(s&f|s&l|f&l)-1894007588:(s^f^l)-899497514);c=l,l=f,f=s<<30|s>>>2,s=a,a=O}a+=p,s+=g,f+=y,l+=v,c+=m}return[a,s,f,l,c]},a=function(t,e){var r=n.wordsToBytes(u(t));return e&&e.asBytes?r:e&&e.asString?o.bytesToString(r):n.bytesToHex(r)};a._blocksize=16,a._digestsize=20,t.exports=a}()}).call(e,r(7).Buffer)},function(t,e,r){(function(t,n){/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
"use strict";function i(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(e){return!1}}function o(){return t.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(e,r){if(o()<r)throw new RangeError("Invalid typed array length");return t.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(r),e.__proto__=t.prototype):(null===e&&(e=new t(r)),e.length=r),e}function t(e,r,n){if(!(t.TYPED_ARRAY_SUPPORT||this instanceof t))return new t(e,r,n);if("number"==typeof e){if("string"==typeof r)throw new Error("If encoding is specified then the first argument must be a string");return l(this,e)}return a(this,e,r,n)}function a(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?p(t,e,r,n):"string"==typeof e?c(t,e,r):g(t,e)}function s(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function f(t,e,r,n){return s(e),e<=0?u(t,e):void 0!==r?"string"==typeof n?u(t,e).fill(r,n):u(t,e).fill(r):u(t,e)}function l(e,r){if(s(r),e=u(e,r<0?0:0|y(r)),!t.TYPED_ARRAY_SUPPORT)for(var n=0;n<r;++n)e[n]=0;return e}function c(e,r,n){if("string"==typeof n&&""!==n||(n="utf8"),!t.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|m(r,n);e=u(e,i);var o=e.write(r,n);return o!==i&&(e=e.slice(0,o)),e}function h(t,e){var r=e.length<0?0:0|y(e.length);t=u(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function p(e,r,n,i){if(r.byteLength,n<0||r.byteLength<n)throw new RangeError("'offset' is out of bounds");if(r.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");return r=void 0===n&&void 0===i?new Uint8Array(r):void 0===i?new Uint8Array(r,n):new Uint8Array(r,n,i),t.TYPED_ARRAY_SUPPORT?(e=r,e.__proto__=t.prototype):e=h(e,r),e}function g(e,r){if(t.isBuffer(r)){var n=0|y(r.length);return e=u(e,n),0===e.length?e:(r.copy(e,0,0,n),e)}if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||V(r.length)?u(e,0):h(e,r);if("Buffer"===r.type&&$(r.data))return h(e,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function y(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function v(e){return+e!=e&&(e=0),t.alloc(+e)}function m(e,r){if(t.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(r){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Z(e).length;default:if(i)return H(e).length;r=(""+r).toLowerCase(),i=!0}}function d(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,e>>>=0,r<=e)return"";for(t||(t="utf8");;)switch(t){case"hex":return B(this,e,r);case"utf8":case"utf-8":return j(this,e,r);case"ascii":return R(this,e,r);case"latin1":case"binary":return M(this,e,r);case"base64":return S(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function _(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function O(e,r,n,i,o){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof r&&(r=t.from(r,i)),t.isBuffer(r))return 0===r.length?-1:b(e,r,n,i,o);if("number"==typeof r)return r=255&r,t.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,r,n):Uint8Array.prototype.lastIndexOf.call(e,r,n):b(e,[r],n,i,o);throw new TypeError("val must be string, number or Buffer")}function b(t,e,r,n,i){function o(t,e){return 1===u?t[e]:t.readUInt16BE(e*u)}var u=1,a=t.length,s=e.length;if(void 0!==n&&(n=String(n).toLowerCase(),"ucs2"===n||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;u=2,a/=2,s/=2,r/=2}var f;if(i){var l=-1;for(f=r;f<a;f++)if(o(t,f)===o(e,l===-1?0:f-l)){if(l===-1&&(l=f),f-l+1===s)return l*u}else l!==-1&&(f-=f-l),l=-1}else for(r+s>a&&(r=a-s),f=r;f>=0;f--){for(var c=!0,h=0;h<s;h++)if(o(t,f+h)!==o(e,h)){c=!1;break}if(c)return f}return-1}function E(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;var o=e.length;if(o%2!==0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var u=0;u<n;++u){var a=parseInt(e.substr(2*u,2),16);if(isNaN(a))return u;t[r+u]=a}return u}function x(t,e,r,n){return J(H(e,t.length-r),t,r,n)}function w(t,e,r,n){return J(W(e),t,r,n)}function P(t,e,r,n){return w(t,e,r,n)}function A(t,e,r,n){return J(Z(e),t,r,n)}function k(t,e,r,n){return J(K(e,t.length-r),t,r,n)}function S(t,e,r){return 0===e&&r===t.length?X.fromByteArray(t):X.fromByteArray(t.slice(e,r))}function j(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var o=t[i],u=null,a=o>239?4:o>223?3:o>191?2:1;if(i+a<=r){var s,f,l,c;switch(a){case 1:o<128&&(u=o);break;case 2:s=t[i+1],128===(192&s)&&(c=(31&o)<<6|63&s,c>127&&(u=c));break;case 3:s=t[i+1],f=t[i+2],128===(192&s)&&128===(192&f)&&(c=(15&o)<<12|(63&s)<<6|63&f,c>2047&&(c<55296||c>57343)&&(u=c));break;case 4:s=t[i+1],f=t[i+2],l=t[i+3],128===(192&s)&&128===(192&f)&&128===(192&l)&&(c=(15&o)<<18|(63&s)<<12|(63&f)<<6|63&l,c>65535&&c<1114112&&(u=c))}}null===u?(u=65533,a=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),i+=a}return T(n)}function T(t){var e=t.length;if(e<=tt)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=tt));return r}function R(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function M(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function B(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=e;o<r;++o)i+=z(t[o]);return i}function L(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function C(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function I(e,r,n,i,o,u){if(!t.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>o||r<u)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function U(t,e,r,n){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-r,2);i<o;++i)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function N(t,e,r,n){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-r,4);i<o;++i)t[r+i]=e>>>8*(n?i:3-i)&255}function Y(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function D(t,e,r,n,i){return i||Y(t,e,r,4,3.4028234663852886e38,-3.4028234663852886e38),Q.write(t,e,r,n,23,4),r+4}function q(t,e,r,n,i){return i||Y(t,e,r,8,1.7976931348623157e308,-1.7976931348623157e308),Q.write(t,e,r,n,52,8),r+8}function F(t){if(t=G(t).replace(et,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function G(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function z(t){return t<16?"0"+t.toString(16):t.toString(16)}function H(t,e){e=e||1/0;for(var r,n=t.length,i=null,o=[],u=0;u<n;++u){if(r=t.charCodeAt(u),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(u+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function W(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}function K(t,e){for(var r,n,i,o=[],u=0;u<t.length&&!((e-=2)<0);++u)r=t.charCodeAt(u),n=r>>8,i=r%256,o.push(i),o.push(n);return o}function Z(t){return X.toByteArray(F(t))}function J(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function V(t){return t!==t}var X=r(8),Q=r(9),$=r(10);e.Buffer=t,e.SlowBuffer=v,e.INSPECT_MAX_BYTES=50,t.TYPED_ARRAY_SUPPORT=void 0!==n.TYPED_ARRAY_SUPPORT?n.TYPED_ARRAY_SUPPORT:i(),e.kMaxLength=o(),t.poolSize=8192,t._augment=function(e){return e.__proto__=t.prototype,e},t.from=function(t,e,r){return a(null,t,e,r)},t.TYPED_ARRAY_SUPPORT&&(t.prototype.__proto__=Uint8Array.prototype,t.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&t[Symbol.species]===t&&Object.defineProperty(t,Symbol.species,{value:null,configurable:!0})),t.alloc=function(t,e,r){return f(null,t,e,r)},t.allocUnsafe=function(t){return l(null,t)},t.allocUnsafeSlow=function(t){return l(null,t)},t.isBuffer=function(t){return!(null==t||!t._isBuffer)},t.compare=function(e,r){if(!t.isBuffer(e)||!t.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(e===r)return 0;for(var n=e.length,i=r.length,o=0,u=Math.min(n,i);o<u;++o)if(e[o]!==r[o]){n=e[o],i=r[o];break}return n<i?-1:i<n?1:0},t.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},t.concat=function(e,r){if(!$(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return t.alloc(0);var n;if(void 0===r)for(r=0,n=0;n<e.length;++n)r+=e[n].length;var i=t.allocUnsafe(r),o=0;for(n=0;n<e.length;++n){var u=e[n];if(!t.isBuffer(u))throw new TypeError('"list" argument must be an Array of Buffers');u.copy(i,o),o+=u.length}return i},t.byteLength=m,t.prototype._isBuffer=!0,t.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)_(this,e,e+1);return this},t.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)_(this,e,e+3),_(this,e+1,e+2);return this},t.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)_(this,e,e+7),_(this,e+1,e+6),_(this,e+2,e+5),_(this,e+3,e+4);return this},t.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?j(this,0,t):d.apply(this,arguments)},t.prototype.equals=function(e){if(!t.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===t.compare(this,e)},t.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},t.prototype.compare=function(e,r,n,i,o){if(!t.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),r<0||n>e.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&r>=n)return 0;if(i>=o)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,i>>>=0,o>>>=0,this===e)return 0;for(var u=o-i,a=n-r,s=Math.min(u,a),f=this.slice(i,o),l=e.slice(r,n),c=0;c<s;++c)if(f[c]!==l[c]){u=f[c],a=l[c];break}return u<a?-1:a<u?1:0},t.prototype.includes=function(t,e,r){return this.indexOf(t,e,r)!==-1},t.prototype.indexOf=function(t,e,r){return O(this,t,e,r,!0)},t.prototype.lastIndexOf=function(t,e,r){return O(this,t,e,r,!1)},t.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e=0|e,isFinite(r)?(r=0|r,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return E(this,t,e,r);case"utf8":case"utf-8":return x(this,t,e,r);case"ascii":return w(this,t,e,r);case"latin1":case"binary":return P(this,t,e,r);case"base64":return A(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},t.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var tt=4096;t.prototype.slice=function(e,r){var n=this.length;e=~~e,r=void 0===r?n:~~r,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),r<0?(r+=n,r<0&&(r=0)):r>n&&(r=n),r<e&&(r=e);var i;if(t.TYPED_ARRAY_SUPPORT)i=this.subarray(e,r),i.__proto__=t.prototype;else{var o=r-e;i=new t(o,(void 0));for(var u=0;u<o;++u)i[u]=this[u+e]}return i},t.prototype.readUIntLE=function(t,e,r){t=0|t,e=0|e,r||C(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n},t.prototype.readUIntBE=function(t,e,r){t=0|t,e=0|e,r||C(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},t.prototype.readUInt8=function(t,e){return e||C(t,1,this.length),this[t]},t.prototype.readUInt16LE=function(t,e){return e||C(t,2,this.length),this[t]|this[t+1]<<8},t.prototype.readUInt16BE=function(t,e){return e||C(t,2,this.length),this[t]<<8|this[t+1]},t.prototype.readUInt32LE=function(t,e){return e||C(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},t.prototype.readUInt32BE=function(t,e){return e||C(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},t.prototype.readIntLE=function(t,e,r){t=0|t,e=0|e,r||C(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*e)),n},t.prototype.readIntBE=function(t,e,r){t=0|t,e=0|e,r||C(t,e,this.length);for(var n=e,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*e)),o},t.prototype.readInt8=function(t,e){return e||C(t,1,this.length),128&this[t]?(255-this[t]+1)*-1:this[t]},t.prototype.readInt16LE=function(t,e){e||C(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},t.prototype.readInt16BE=function(t,e){e||C(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},t.prototype.readInt32LE=function(t,e){return e||C(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},t.prototype.readInt32BE=function(t,e){return e||C(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},t.prototype.readFloatLE=function(t,e){return e||C(t,4,this.length),Q.read(this,t,!0,23,4)},t.prototype.readFloatBE=function(t,e){return e||C(t,4,this.length),Q.read(this,t,!1,23,4)},t.prototype.readDoubleLE=function(t,e){return e||C(t,8,this.length),Q.read(this,t,!0,52,8)},t.prototype.readDoubleBE=function(t,e){return e||C(t,8,this.length),Q.read(this,t,!1,52,8)},t.prototype.writeUIntLE=function(t,e,r,n){if(t=+t,e=0|e,r=0|r,!n){var i=Math.pow(2,8*r)-1;I(this,t,e,r,i,0)}var o=1,u=0;for(this[e]=255&t;++u<r&&(o*=256);)this[e+u]=t/o&255;return e+r},t.prototype.writeUIntBE=function(t,e,r,n){if(t=+t,e=0|e,r=0|r,!n){var i=Math.pow(2,8*r)-1;I(this,t,e,r,i,0)}var o=r-1,u=1;for(this[e+o]=255&t;--o>=0&&(u*=256);)this[e+o]=t/u&255;return e+r},t.prototype.writeUInt8=function(e,r,n){return e=+e,r=0|r,n||I(this,e,r,1,255,0),t.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[r]=255&e,r+1},t.prototype.writeUInt16LE=function(e,r,n){return e=+e,r=0|r,n||I(this,e,r,2,65535,0),t.TYPED_ARRAY_SUPPORT?(this[r]=255&e,this[r+1]=e>>>8):U(this,e,r,!0),r+2},t.prototype.writeUInt16BE=function(e,r,n){return e=+e,r=0|r,n||I(this,e,r,2,65535,0),t.TYPED_ARRAY_SUPPORT?(this[r]=e>>>8,this[r+1]=255&e):U(this,e,r,!1),r+2},t.prototype.writeUInt32LE=function(e,r,n){return e=+e,r=0|r,n||I(this,e,r,4,4294967295,0),t.TYPED_ARRAY_SUPPORT?(this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=255&e):N(this,e,r,!0),r+4},t.prototype.writeUInt32BE=function(e,r,n){return e=+e,r=0|r,n||I(this,e,r,4,4294967295,0),t.TYPED_ARRAY_SUPPORT?(this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=255&e):N(this,e,r,!1),r+4},t.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e=0|e,!n){var i=Math.pow(2,8*r-1);I(this,t,e,r,i-1,-i)}var o=0,u=1,a=0;for(this[e]=255&t;++o<r&&(u*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/u>>0)-a&255;return e+r},t.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e=0|e,!n){var i=Math.pow(2,8*r-1);I(this,t,e,r,i-1,-i)}var o=r-1,u=1,a=0;for(this[e+o]=255&t;--o>=0&&(u*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/u>>0)-a&255;return e+r},t.prototype.writeInt8=function(e,r,n){return e=+e,r=0|r,n||I(this,e,r,1,127,-128),t.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[r]=255&e,r+1},t.prototype.writeInt16LE=function(e,r,n){return e=+e,r=0|r,n||I(this,e,r,2,32767,-32768),t.TYPED_ARRAY_SUPPORT?(this[r]=255&e,this[r+1]=e>>>8):U(this,e,r,!0),r+2},t.prototype.writeInt16BE=function(e,r,n){return e=+e,r=0|r,n||I(this,e,r,2,32767,-32768),t.TYPED_ARRAY_SUPPORT?(this[r]=e>>>8,this[r+1]=255&e):U(this,e,r,!1),r+2},t.prototype.writeInt32LE=function(e,r,n){return e=+e,r=0|r,n||I(this,e,r,4,2147483647,-2147483648),t.TYPED_ARRAY_SUPPORT?(this[r]=255&e,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24):N(this,e,r,!0),r+4},t.prototype.writeInt32BE=function(e,r,n){return e=+e,r=0|r,n||I(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),t.TYPED_ARRAY_SUPPORT?(this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=255&e):N(this,e,r,!1),r+4},t.prototype.writeFloatLE=function(t,e,r){return D(this,t,e,!0,r)},t.prototype.writeFloatBE=function(t,e,r){return D(this,t,e,!1,r)},t.prototype.writeDoubleLE=function(t,e,r){return q(this,t,e,!0,r)},t.prototype.writeDoubleBE=function(t,e,r){return q(this,t,e,!1,r)},t.prototype.copy=function(e,r,n,i){if(n||(n=0),i||0===i||(i=this.length),r>=e.length&&(r=e.length),r||(r=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-r<i-n&&(i=e.length-r+n);var o,u=i-n;if(this===e&&n<r&&r<i)for(o=u-1;o>=0;--o)e[o+r]=this[o+n];else if(u<1e3||!t.TYPED_ARRAY_SUPPORT)for(o=0;o<u;++o)e[o+r]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+u),r);return u},t.prototype.fill=function(e,r,n,i){if("string"==typeof e){if("string"==typeof r?(i=r,r=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!t.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e=255&e);if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;r>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var u;if("number"==typeof e)for(u=r;u<n;++u)this[u]=e;else{var a=t.isBuffer(e)?e:H(new t(e,i).toString()),s=a.length;for(u=0;u<n-r;++u)this[u+r]=a[u%s]}return this};var et=/[^+\/0-9A-Za-z-_]/g}).call(e,r(7).Buffer,function(){return this}())},function(t,e){"use strict";function r(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,r=t.length;e<r;++e)a[e]=t[e],s[t.charCodeAt(e)]=e;s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63}function n(t){var e,r,n,i,o,u,a=t.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===t[a-2]?2:"="===t[a-1]?1:0,u=new f(3*a/4-o),n=o>0?a-4:a;var l=0;for(e=0,r=0;e<n;e+=4,r+=3)i=s[t.charCodeAt(e)]<<18|s[t.charCodeAt(e+1)]<<12|s[t.charCodeAt(e+2)]<<6|s[t.charCodeAt(e+3)],u[l++]=i>>16&255,u[l++]=i>>8&255,u[l++]=255&i;return 2===o?(i=s[t.charCodeAt(e)]<<2|s[t.charCodeAt(e+1)]>>4,u[l++]=255&i):1===o&&(i=s[t.charCodeAt(e)]<<10|s[t.charCodeAt(e+1)]<<4|s[t.charCodeAt(e+2)]>>2,u[l++]=i>>8&255,u[l++]=255&i),u}function i(t){return a[t>>18&63]+a[t>>12&63]+a[t>>6&63]+a[63&t]}function o(t,e,r){for(var n,o=[],u=e;u<r;u+=3)n=(t[u]<<16)+(t[u+1]<<8)+t[u+2],o.push(i(n));return o.join("")}function u(t){for(var e,r=t.length,n=r%3,i="",u=[],s=16383,f=0,l=r-n;f<l;f+=s)u.push(o(t,f,f+s>l?l:f+s));return 1===n?(e=t[r-1],i+=a[e>>2],i+=a[e<<4&63],i+="=="):2===n&&(e=(t[r-2]<<8)+t[r-1],i+=a[e>>10],i+=a[e>>4&63],i+=a[e<<2&63],i+="="),u.push(i),u.join("")}e.toByteArray=n,e.fromByteArray=u;var a=[],s=[],f="undefined"!=typeof Uint8Array?Uint8Array:Array;r()},function(t,e){e.read=function(t,e,r,n,i){var o,u,a=8*i-n-1,s=(1<<a)-1,f=s>>1,l=-7,c=r?i-1:0,h=r?-1:1,p=t[e+c];for(c+=h,o=p&(1<<-l)-1,p>>=-l,l+=a;l>0;o=256*o+t[e+c],c+=h,l-=8);for(u=o&(1<<-l)-1,o>>=-l,l+=n;l>0;u=256*u+t[e+c],c+=h,l-=8);if(0===o)o=1-f;else{if(o===s)return u?NaN:(p?-1:1)*(1/0);u+=Math.pow(2,n),o-=f}return(p?-1:1)*u*Math.pow(2,o-n)},e.write=function(t,e,r,n,i,o){var u,a,s,f=8*o-i-1,l=(1<<f)-1,c=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,g=n?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,u=l):(u=Math.floor(Math.log(e)/Math.LN2),e*(s=Math.pow(2,-u))<1&&(u--,s*=2),e+=u+c>=1?h/s:h*Math.pow(2,1-c),e*s>=2&&(u++,s/=2),u+c>=l?(a=0,u=l):u+c>=1?(a=(e*s-1)*Math.pow(2,i),u+=c):(a=e*Math.pow(2,c-1)*Math.pow(2,i),u=0));i>=8;t[r+p]=255&a,p+=g,a/=256,i-=8);for(u=u<<i|a,f+=i;f>0;t[r+p]=255&u,p+=g,u/=256,f-=8);t[r+p-g]|=128*y}},function(t,e){var r={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},function(t,e){!function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&r.rotl(t,8)|4278255360&r.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=r.endian(t[e]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],r=0,n=0;r<t.length;r++,n+=8)e[n>>>5]|=t[r]<<24-n%32;return e},wordsToBytes:function(t){for(var e=[],r=0;r<32*t.length;r+=8)e.push(t[r>>>5]>>>24-r%32&255);return e},bytesToHex:function(t){for(var e=[],r=0;r<t.length;r++)e.push((t[r]>>>4).toString(16)),e.push((15&t[r]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(parseInt(t.substr(r,2),16));return e},bytesToBase64:function(t){for(var r=[],n=0;n<t.length;n+=3)for(var i=t[n]<<16|t[n+1]<<8|t[n+2],o=0;o<4;o++)8*n+6*o<=8*t.length?r.push(e.charAt(i>>>6*(3-o)&63)):r.push("=");return r.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var r=[],n=0,i=0;n<t.length;i=++n%4)0!=i&&r.push((e.indexOf(t.charAt(n-1))&Math.pow(2,-2*i+8)-1)<<2*i|e.indexOf(t.charAt(n))>>>6-2*i);return r}};t.exports=r}()},function(t,e){var r={utf8:{stringToBytes:function(t){return r.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(r.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],r=0;r<t.length;r++)e.push(255&t.charCodeAt(r));return e},bytesToString:function(t){for(var e=[],r=0;r<t.length;r++)e.push(String.fromCharCode(t[r]));return e.join("")}}};t.exports=r},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=r(2),a=n(u),s=r(14),f=r(5),l=function(){function t(e){var r=arguments.length<=1||void 0===arguments[1]?"global_salt":arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],o=arguments[3];i(this,t),this._serialization=e,o?this._env=o:this._env=new a["default"](r),this.experimentSalt=this._experimentSalt=r,this._evaluated=!1,this._inExperiment=!1,this._inputs=(0,f.shallowCopy)(n)}return o(t,[{key:"inExperiment",value:function(){return this._inExperiment}},{key:"setEnv",value:function(t){return this._env=(0,f.deepCopy)(t),this}},{key:"has",value:function(t){return this._env[t]}},{key:"get",value:function(t,e){var r=this._inputs[t];null!==r&&void 0!==r||(r=e);var n=this._env.get(t);return void 0!==n&&null!==n?n:r}},{key:"getParams",value:function(){if(!this._evaluated){try{this.evaluate(this._serialization)}catch(t){t instanceof s.StopPlanOutException&&(this._inExperiment=t.inExperiment)}this._evaluated=!0}return this._env.getParams()}},{key:"set",value:function(t,e){return this._env.set(t,e),this}},{key:"getSaltSeparator",value:function(){return this._env.saltSeparator}},{key:"setOverrides",value:function(t){return this._env.setOverrides(t),this}},{key:"getOverrides",value:function(){return this._env.getOverrides()}},{key:"hasOverride",value:function(t){var e=this.getOverrides();return e&&void 0!==e[t]}},{key:"registerCustomOperators",value:function(t){(0,s.registerOperators)(t)}},{key:"evaluate",value:function(t){if((0,f.isObject)(t)&&t.op)return(0,s.operatorInstance)(t).execute(this);if((0,f.isArray)(t)){var e=this;return(0,f.map)(t,function(t){return e.evaluate(t)})}return t}}]),t}();e["default"]=l,t.exports=e["default"]},function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e["default"]=t,e}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.registerOperators=e.StopPlanOutException=e.operatorInstance=e.isOperator=e.initFactory=e.operators=void 0;var o=r(15),u=n(o),a=r(3),s=n(a),f=r(5),l=function(){return{literal:u.Literal,get:u.Get,set:u.Set,seq:u.Seq,"return":u.Return,index:u.Index,array:u.Arr,equals:u.Equals,and:u.And,or:u.Or,">":u.GreaterThan,"<":u.LessThan,">=":u.GreaterThanOrEqualTo,"<=":u.LessThanOrEqualTo,"%":u.Mod,"/":u.Divide,not:u.Not,round:u.Round,negative:u.Negative,min:u.Min,max:u.Max,length:u.Length,coalesce:u.Coalesce,map:u.Map,cond:u.Cond,product:u.Product,sum:u.Sum,randomFloat:s.RandomFloat,randomInteger:s.RandomInteger,bernoulliTrial:s.BernoulliTrial,bernoulliFilter:s.BernoulliFilter,uniformChoice:s.UniformChoice,weightedChoice:s.WeightedChoice,sample:s.Sample}},c=l(),h=function(t){return(0,f.isObject)(t)&&t.op},p=function(t){var e=t.op;if(!c[e])throw"Unknown Operator "+e;return new c[e](t)},g=function(t){(0,f.forEach)(t,function(t,e){if(c[e])throw e+" already is defined";c[e]=t})},y=function v(t){i(this,v),this.inExperiment=t};e.operators=c,e.initFactory=l,e.isOperator=h,e.operatorInstance=p,e.StopPlanOutException=y,e.registerOperators=g},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Return=e.Length=e.Max=e.Min=e.Negative=e.Not=e.Round=e.Divide=e.Mod=e.GreaterThanOrEqualTo=e.LessThanOrEqualTo=e.LessThan=e.GreaterThan=e.Equals=e.Sum=e.Product=e.Or=e.And=e.Cond=e.Index=e.Coalesce=e.Map=e.Arr=e.Set=e.Seq=e.Get=e.Literal=void 0;var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=r(4),s=r(14),f=r(5),l=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"execute",value:function(t){return this.getArgMixed("value")}}]),e}(a.PlanOutOp),c=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"execute",value:function(t){return t.get(this.getArgString("var"))}}]),e}(a.PlanOutOp),h=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"execute",value:function(t){(0,f.forEach)(this.getArgList("seq"),function(e){t.evaluate(e)})}}]),e}(a.PlanOutOp),p=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"execute",value:function(t){var e=t.evaluate(this.getArgMixed("value")),r=!1;throw e&&(r=!0),new s.StopPlanOutException(r)}}]),e}(a.PlanOutOp),g=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"execute",value:function(t){var e=this.getArgString("var"),r=this.getArgMixed("value");t.hasOverride(e)||(r&&(0,s.isOperator)(r)&&!r.salt&&(r.salt=e),"experimentSalt"==e&&(t.experimentSalt=r),t.set(e,t.evaluate(r)))}}]),e}(a.PlanOutOp),y=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"execute",value:function(t){return(0,f.map)(this.getArgList("values"),function(e){return t.evaluate(e)})}}]),e}(a.PlanOutOp),v=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"execute",value:function(t){for(var e=this.getArgList("values"),r=0;r<e.length;r++){var n=e[r],i=t.evaluate(n);if(null!==i&&void 0!==i)return i}return null}}]),e}(a.PlanOutOp),m=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"simpleExecute",value:function(){var t=this.getArgIndexish("base"),e=this.getArgMixed("index");return"number"==typeof e?e>=0&&e<t.length?t[e]:void 0:t[e]}}]),e}(a.PlanOutOpSimple),d=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"execute",value:function(t){var e=this.getArgList("cond");for(var r in e){var n=e[r]["if"],i=e[r].then;if(t.evaluate(n))return t.evaluate(i)}return null}}]),e}(a.PlanOutOp),_=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"execute",value:function(t){return(0,f.reduce)(this.getArgList("values"),function(e,r){return e?Boolean(t.evaluate(r)):e},!0)}}]),e}(a.PlanOutOp),O=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"execute",value:function(t){return(0,f.reduce)(this.getArgList("values"),function(e,r){return e?e:Boolean(t.evaluate(r))},!1)}}]),e}(a.PlanOutOp),b=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"commutativeExecute",
value:function(t){return(0,f.reduce)(t,function(t,e){return t*e},1)}}]),e}(a.PlanOutOpCommutative),E=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"commutativeExecute",value:function(t){return(0,f.reduce)(t,function(t,e){return t+e},0)}}]),e}(a.PlanOutOpCommutative),x=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"getInfixString",value:function(){return"=="}},{key:"binaryExecute",value:function(t,e){return t===e}}]),e}(a.PlanOutOpBinary),w=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"binaryExecute",value:function(t,e){return t>e}}]),e}(a.PlanOutOpBinary),P=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"binaryExecute",value:function(t,e){return t<e}}]),e}(a.PlanOutOpBinary),A=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"binaryExecute",value:function(t,e){return t<=e}}]),e}(a.PlanOutOpBinary),k=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"binaryExecute",value:function(t,e){return t>=e}}]),e}(a.PlanOutOpBinary),S=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"binaryExecute",value:function(t,e){return t%e}}]),e}(a.PlanOutOpBinary),j=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"binaryExecute",value:function(t,e){return parseFloat(t)/parseFloat(e)}}]),e}(a.PlanOutOpBinary),T=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"unaryExecute",value:function(t){return Math.round(t)}}]),e}(a.PlanOutOpUnary),R=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"getUnaryString",value:function(){return"!"}},{key:"unaryExecute",value:function(t){return!t}}]),e}(a.PlanOutOpUnary),M=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"getUnaryString",value:function(){return"-"}},{key:"unaryExecute",value:function(t){return 0-t}}]),e}(a.PlanOutOpUnary),B=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"commutativeExecute",value:function(t){return Math.min.apply(null,t)}}]),e}(a.PlanOutOpCommutative),L=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"commutativeExecute",value:function(t){return Math.max.apply(null,t)}}]),e}(a.PlanOutOpCommutative),C=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"unaryExecute",value:function(t){return t.length}}]),e}(a.PlanOutOpUnary),I=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),u(e,[{key:"simpleExecute",value:function(){var t=(0,f.deepCopy)(this.args);return delete t.op,delete t.salt,t}}]),e}(a.PlanOutOpSimple);e.Literal=l,e.Get=c,e.Seq=h,e.Set=g,e.Arr=y,e.Map=I,e.Coalesce=v,e.Index=m,e.Cond=d,e.And=_,e.Or=O,e.Product=b,e.Sum=E,e.Equals=x,e.GreaterThan=w,e.LessThan=P,e.LessThanOrEqualTo=A,e.GreaterThanOrEqualTo=k,e.Mod=S,e.Divide=j,e.Round=T,e.Not=R,e.Negative=M,e.Min=B,e.Max=L,e.Length=C,e.Return=p},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.SimpleNamespace=e.Namespace=void 0;var a=function _(t,e,r){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(void 0===n){var i=Object.getPrototypeOf(t);return null===i?void 0:_(i,e,r)}if("value"in n)return n.value;var o=n.get;if(void 0!==o)return o.call(r)},s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),f=r(1),l=n(f),c=r(2),h=n(c),p=r(3),g=r(5),y=r(17),v=function(t){function e(){return i(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return u(e,t),s(e,[{key:"configureLogger",value:function(){}},{key:"setup",value:function(){this.name="test_name"}},{key:"log",value:function(t){}},{key:"getParamNames",value:function(){return this.getDefaultParamNames()}},{key:"previouslyLogged",value:function(){return!0}},{key:"assign",value:function(t,e){}}]),e}(l["default"]),m=function(){function t(){i(this,t)}return s(t,[{key:"addExperiment",value:function(t,e,r){throw"IMPLEMENT addExperiment"}},{key:"removeExperiment",value:function(t){throw"IMPLEMENT removeExperiment"}},{key:"setAutoExposureLogging",value:function(t){throw"IMPLEMENT setAutoExposureLogging"}},{key:"inExperiment",value:function(){throw"IMPLEMENT inExperiment"}},{key:"get",value:function(t,e){throw"IMPLEMENT get"}},{key:"logExposure",value:function(t){throw"IMPLEMENT logExposure"}},{key:"logEvent",value:function(t,e){throw"IMPLEMENT logEvent"}},{key:"requireExperiment",value:function(){this._experiment||this._assignExperiment()}},{key:"requireDefaultExperiment",value:function(){this._defaultExperiment||this._assignDefaultExperiment()}}]),t}(),d=function(t){function e(t){i(this,e);var r=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.name=r.getDefaultNamespaceName(),r.inputs=t||{},r.numSegments=1,r.segmentAllocations={},r.currentExperiments={},r._experiment=null,r._defaultExperiment=null,r.defaultExperimentClass=v,r._inExperiment=!1,r.setupDefaults(),r.setup(),r.availableSegments=(0,g.range)(r.numSegments),r.setupExperiments(),r}return u(e,t),s(e,[{key:"setupDefaults",value:function(){}},{key:"setup",value:function(){throw"IMPLEMENT setup"}},{key:"setupExperiments",value:function(){throw"IMPLEMENT setupExperiments"}},{key:"getPrimaryUnit",value:function(){return this._primaryUnit}},{key:"allowedOverride",value:function(){return!1}},{key:"getOverrides",value:function(){return{}}},{key:"setPrimaryUnit",value:function(t){this._primaryUnit=t}},{key:"addExperiment",value:function(t,e,r){var n=this.availableSegments.length;if(n<r)return!1;if(void 0!==this.currentExperiments[t])return!1;var i=new h["default"](this.name);i.set("sampled_segments",new p.Sample({choices:this.availableSegments,draws:r,unit:t}));for(var o=i.get("sampled_segments"),u=0;u<o.length;u++){this.segmentAllocations[o[u]]=t;var a=this.availableSegments.indexOf(o[u]);this.availableSegments[a]=this.availableSegments[n-1],this.availableSegments.splice(n-1,1),n-=1}this.currentExperiments[t]=e}},{key:"removeExperiment",value:function(t){var e=this;return void 0!==this.currentExperiments[t]&&((0,g.forEach)(Object.keys(this.segmentAllocations),function(r){e.segmentAllocations[r]===t&&(delete e.segmentAllocations[r],e.availableSegments.push(r))}),delete this.currentExperiments[t],!0)}},{key:"getSegment",value:function(){var t=new h["default"](this.name),e=new p.RandomInteger({min:0,max:this.numSegments-1,unit:this.inputs[this.getPrimaryUnit()]});return t.set("segment",e),t.get("segment")}},{key:"_assignExperiment",value:function(){this.inputs=(0,g.extend)(this.inputs,(0,y.getExperimentInputs)(this.getName()));var t=this.getSegment();if(void 0!==this.segmentAllocations[t]){var e=this.segmentAllocations[t];this._assignExperimentObject(e)}}},{key:"_assignExperimentObject",value:function(t){var e=new this.currentExperiments[t](this.inputs);e.setName(this.getName()+"-"+t),e.setSalt(this.getName()+"-"+t),this._experiment=e,this._inExperiment=e.inExperiment(),this._inExperiment||this._assignDefaultExperiment()}},{key:"_assignDefaultExperiment",value:function(){this._defaultExperiment=new this.defaultExperimentClass(this.inputs)}},{key:"defaultGet",value:function(t,r){return a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"requireDefaultExperiment",this).call(this),this._defaultExperiment.get(t,r)}},{key:"getName",value:function(){return this.name}},{key:"setName",value:function(t){this.name=t}},{key:"previouslyLogged",value:function(){return this._experiment?this._experiment.previouslyLogged():null}},{key:"inExperiment",value:function(){return a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"requireExperiment",this).call(this),this._inExperiment}},{key:"setAutoExposureLogging",value:function(t){this._autoExposureLoggingSet=t,this._defaultExperiment&&this._defaultExperiment.setAutoExposureLogging(t),this._experiment&&this._experiment.setAutoExposureLogging(t)}},{key:"setGlobalOverride",value:function(t){var e=this.getOverrides();if(e&&(0,g.hasKey)(e,t)){var r=e[t];r&&(0,g.hasKey)(this.currentExperiments,r.experimentName)&&(this._assignExperimentObject(r.experimentName),this._experiment.addOverride(t,r.value))}}},{key:"setLocalOverride",value:function(t){var e=(0,g.getParameterByName)("experimentOverride");e&&(0,g.hasKey)(this.currentExperiments,e)&&(this._assignExperimentObject(e),(0,g.getParameterByName)(t)&&this._experiment.addOverride(t,(0,g.getParameterByName)(t)))}},{key:"getParams",value:function(t){return a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"requireExperiment",this).call(this),this._experiment&&this.getOriginalExperimentName()===t?this._experiment.getParams():null}},{key:"getOriginalExperimentName",value:function(){return this._experiment?this._experiment.getName().split("-")[1]:null}},{key:"get",value:function(t,r){return a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"requireExperiment",this).call(this),this.allowedOverride()&&this.setGlobalOverride(t),this.setLocalOverride(t),this._experiment?(void 0!==this._autoExposureLoggingSet&&this._experiment.setAutoExposureLogging(this._autoExposureLoggingSet),this._experiment.get(t,this.defaultGet(t,r))):this.defaultGet(t,r)}},{key:"logExposure",value:function(t){a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"requireExperiment",this).call(this),this._experiment&&this._experiment.logExposure(t)}},{key:"logEvent",value:function(t,r){a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"requireExperiment",this).call(this),this._experiment&&this._experiment.logEvent(t,r)}},{key:"getDefaultNamespaceName",value:function(){if((0,g.isObject)(this)&&this.constructor&&this!==this.window){var t=this.constructor.toString().match(/function\s*(\w+)/);if(t&&2===t.length)return t[1]}return"GenericNamespace"}}]),e}(m);e.Namespace=m,e.SimpleNamespace=d},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(5),i={},o={},u=function(t){return t?a((0,n.shallowCopy)(t)):{}},a=function(t){return(0,n.forEach)(Object.keys(t),function(e){(0,n.isFunction)(t[e])&&(t[e]=t[e]())}),t},s=function(t,e,r){r?(o[r]||(o[r]={}),o[r][t]=e):i[t]=e},f=function(t){var e=u(i);return t&&o[t]?(0,n.extend)(e,u(o[t])):e};e["default"]={registerExperimentInput:s,getExperimentInputs:f},t.exports=e["default"]}])});